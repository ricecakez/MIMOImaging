function [f1,f2,f3] = uni_spect_est(X,R)
Z = UniTrans(X);
dims = size(Z);
M = dims(1);
N = dims(2);
P = dims(3);
J12 = [zeros(M-1,1) eye(M-1)];
tmp = UniMat(M-1)'*J12*UniMat(M);
K11 = real(tmp);
K12 = imag(tmp);
J22 = [zeros(N-1,1) eye(N-1)];
tmp = UniMat(N-1)'*J22*UniMat(N);
K21 = real(tmp);
K22 = imag(tmp);
J32 = [zeros(P-1,1) eye(P-1)];
tmp = UniMat(P-1)'*J32*UniMat(P);
K31 = real(tmp);
K32 = imag(tmp);
[A,B,C] = TALS(Z,R);
phi_a = pinv(K11*A)*K12*A;
phi_b = pinv(K21*B)*K22*B;
phi_c = pinv(K31*C)*K32*C;
f1 = atan(diag(phi_a))/pi;
f2 = atan(diag(phi_b))/pi;
f3 = atan(diag(phi_c))/pi;
