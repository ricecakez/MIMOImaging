function [A,B,C] = TALS(X,R)
Xnorm = norm(X);
A0 = randn(size(X,1),R);
B0 = randn(size(X,2),R);
C0 = randn(size(X,3),R);
% X1 = double(tenmat(X,1));
% [A0,~,~] = svds(X1,R);
% X2 = double(tenmat(X,2));
% [B0,~,~] = svds(X2,R);
% X3 = double(tenmat(X,3));
% [C0,~,~] = svds(X3,R);

% U{1,1} = A0;
% U{1,2} = B0;
% U{1,3} = C0;
% lambda = ones(3,1);
Y = ktensor({A0,B0,C0});
Res0 = 0;
Res = sqrt(Xnorm^2+norm(Y)^2-2 * innerprod(X,Y));
dRes = abs(Res-Res0);
ResTh = 1e-4;
Niter = 100;
ii = 1;
A = A0;
B = B0;
C = C0;
BTB = B'*B;
CTC = C'*C;
while (dRes(ii) >= ResTh) && (ii<=Niter)
    X1 = double(tenmat(X,1));
%     V1 = (CTC*BTB);
    A = X1/(kr(C,B)).';
%     ATA = A'*A;
    X2 = double(tenmat(X,2));
%     V2 = (CTC*ATA);
    B = X2/(kr(C,A)).';
%     BTB = B'*B;
    X3 = double(tenmat(X,3));
%     V3 = (BTB*ATA);
    C = X3/(kr(B,A)).';
%     CTC = C'*C;
%     U{1} = A;
%     U{2} = B;
%     U{3} = C;
    Y = ktensor({A,B,C});
    Res0 = Res;
    Res = sqrt(Xnorm^2+norm(Y)^2-2 * innerprod(X,Y));
    ii = ii + 1;
    dRes(ii) = abs(Res-Res0);
end